<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SQL Analysis Report</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 2em; background: #f9f9f9; color: #222; }
        h1, h2, h3 { color: #2c3e50; }
        .summary-card { background: #eaf6fb; border-radius: 8px; padding: 1em 2em; margin-bottom: 2em; box-shadow: 0 2px 6px #0001; }
        table { border-collapse: collapse; width: 100%; margin-bottom: 2em; }
        th, td { border: 1px solid #bcd; padding: 0.5em 1em; text-align: left; }
        th { background: #e3eaf2; }
        tbody tr:nth-child(odd) { background: #f5f8fa; }
        .error-message { color: #b30000; background: #ffeaea; }
        details { margin-bottom: 1em; }
        summary { font-weight: bold; cursor: pointer; }
        code, pre { font-family: 'Fira Mono', 'Consolas', monospace; background: #f4f4f4; padding: 2px 4px; border-radius: 3px; }
    </style>
</head>
<body>
    <h1>SQL Analysis Report</h1>
    <p>Generated: 2025-04-18 03:00:39 UTC</p>

    <div class="summary-card">
        <h2>Summary</h2>
        <ul>
            <li><strong>Total Statements:</strong> 19</li>
            <li><strong>Total Destructive Statements:</strong> 9</li>
            <li><strong>Total Errors:</strong> 0</li>
        </ul>
        <h3>Statement Counts</h3>
        <table>
            <thead><tr><th>Type</th><th>Count</th></tr></thead>
            <tbody>
            
                <tr><td>USE_DATABASE</td><td>1</td></tr>
            
                <tr><td>USE_SCHEMA</td><td>2</td></tr>
            
                <tr><td>COPY_INTO_TABLE</td><td>1</td></tr>
            
                <tr><td>CREATE_OR_REPLACE_DATABASE</td><td>1</td></tr>
            
                <tr><td>CREATE_OR_REPLACE_TABLE</td><td>2</td></tr>
            
                <tr><td>ALTER_TABLE</td><td>2</td></tr>
            
                <tr><td>CREATE_OR_REPLACE_VIEW</td><td>1</td></tr>
            
                <tr><td>CREATE_FUNCTION</td><td>1</td></tr>
            
                <tr><td>CREATE_OR_REPLACE_PROCEDURE</td><td>1</td></tr>
            
                <tr><td>INSERT</td><td>1</td></tr>
            
                <tr><td>UPDATE</td><td>1</td></tr>
            
                <tr><td>MERGE</td><td>1</td></tr>
            
                <tr><td>DELETE</td><td>1</td></tr>
            
                <tr><td>SELECT</td><td>1</td></tr>
            
                <tr><td>COPY_INTO</td><td>1</td></tr>
            
                <tr><td>CREATE_OR_REPLACE_STAGE</td><td>1</td></tr>
            
            </tbody>
        </table>
        <h3>Destructive Statement Counts</h3>
        <table>
            <thead><tr><th>Type</th><th>Count</th></tr></thead>
            <tbody>
            
                <tr><td>CREATE_OR_REPLACE_TABLE</td><td>4</td></tr>
            
                <tr><td>CREATE_OR_REPLACE_VIEW</td><td>2</td></tr>
            
                <tr><td>UPDATE</td><td>2</td></tr>
            
                <tr><td>DELETE</td><td>1</td></tr>
            
            </tbody>
        </table>
    </div>

    <div class="summary-card">
        <h2>Stage, File Format, and COPY INTO Details</h2>
        <table>
            <thead><tr><th>Type</th><th>Name</th><th>Action</th><th>File</th><th>Line</th></tr></thead>
            <tbody>
            
                <tr>
                    <td>STAGE</td>
                    <td>my_internal_stage</td>
                    <td>CREATE</td>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>116</td>
                </tr>
            
                <tr>
                    <td>TABLE</td>
                    <td>raw_events</td>
                    <td>COPY_INTO_TABLE</td>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>111</td>
                </tr>
            
            </tbody>
        </table>
    </div>

    <h2>Errors</h2>
    
        <p>No errors found.</p>
    

    <h2>Object Interactions</h2>
    <table class="object-table">
        <thead><tr><th>Object Type</th><th>Object Name</th><th>Actions</th></tr></thead>
        <tbody>
        
            <tr>
                <td>DATABASE</td>
                <td>my_sample_db</td>
                <td>CREATE, USE</td>
            </tr>
        
            <tr>
                <td>FUNCTION</td>
                <td>CURRENT_DATE</td>
                <td>REFERENCE</td>
            </tr>
        
            <tr>
                <td>FUNCTION</td>
                <td>PARSE_JSON</td>
                <td>REFERENCE</td>
            </tr>
        
            <tr>
                <td>FUNCTION</td>
                <td>get_user_email</td>
                <td>CREATE</td>
            </tr>
        
            <tr>
                <td>SCHEMA</td>
                <td>production</td>
                <td>USE</td>
            </tr>
        
            <tr>
                <td>SCHEMA</td>
                <td>staging</td>
                <td>USE</td>
            </tr>
        
            <tr>
                <td>STAGE</td>
                <td>my_internal_stage</td>
                <td>CREATE</td>
            </tr>
        
            <tr>
                <td>TABLE</td>
                <td>dim_users</td>
                <td>REPLACE, SELECT</td>
            </tr>
        
            <tr>
                <td>TABLE</td>
                <td>production.dim_users</td>
                <td>INSERT, UPDATE</td>
            </tr>
        
            <tr>
                <td>TABLE</td>
                <td>raw_events</td>
                <td>ALTER, COPY_INTO_TABLE, INSERT, REPLACE, SELECT, UPDATE</td>
            </tr>
        
            <tr>
                <td>TABLE</td>
                <td>staging.raw_events</td>
                <td>SELECT</td>
            </tr>
        
            <tr>
                <td>VIEW</td>
                <td>recent_events_v</td>
                <td>REPLACE</td>
            </tr>
        
        </tbody>
    </table>

    <details>
        <summary>Show Detailed Object Occurrences</summary>
        <table>
            <thead><tr><th>File</th><th>Line</th><th>Column</th><th>Type</th><th>Name</th><th>Action</th></tr></thead>
            <tbody>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>41</td>
                    <td>43</td>
                    <td>FUNCTION</td>
                    <td>CURRENT_DATE</td>
                    <td>REFERENCE</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>81</td>
                    <td>9</td>
                    <td>FUNCTION</td>
                    <td>PARSE_JSON</td>
                    <td>REFERENCE</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>40</td>
                    <td>6</td>
                    <td>TABLE</td>
                    <td>raw_events</td>
                    <td>SELECT</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>84</td>
                    <td>10</td>
                    <td>TABLE</td>
                    <td>staging.raw_events</td>
                    <td>SELECT</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>4</td>
                    <td>28</td>
                    <td>DATABASE</td>
                    <td>my_sample_db</td>
                    <td>CREATE</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>13</td>
                    <td>25</td>
                    <td>TABLE</td>
                    <td>raw_events</td>
                    <td>REPLACE</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>22</td>
                    <td>25</td>
                    <td>TABLE</td>
                    <td>dim_users</td>
                    <td>REPLACE</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>31</td>
                    <td>13</td>
                    <td>TABLE</td>
                    <td>raw_events</td>
                    <td>ALTER</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>34</td>
                    <td>24</td>
                    <td>VIEW</td>
                    <td>recent_events_v</td>
                    <td>REPLACE</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>43</td>
                    <td>28</td>
                    <td>FUNCTION</td>
                    <td>get_user_email</td>
                    <td>CREATE</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>116</td>
                    <td>25</td>
                    <td>STAGE</td>
                    <td>my_internal_stage</td>
                    <td>CREATE</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>67</td>
                    <td>13</td>
                    <td>TABLE</td>
                    <td>raw_events</td>
                    <td>INSERT</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>73</td>
                    <td>8</td>
                    <td>TABLE</td>
                    <td>raw_events</td>
                    <td>UPDATE</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>77</td>
                    <td>12</td>
                    <td>TABLE</td>
                    <td>production.dim_users</td>
                    <td>UPDATE</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>77</td>
                    <td>12</td>
                    <td>TABLE</td>
                    <td>production.dim_users</td>
                    <td>INSERT</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>6</td>
                    <td>14</td>
                    <td>DATABASE</td>
                    <td>my_sample_db</td>
                    <td>USE</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>11</td>
                    <td>12</td>
                    <td>SCHEMA</td>
                    <td>staging</td>
                    <td>USE</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>98</td>
                    <td>12</td>
                    <td>SCHEMA</td>
                    <td>production</td>
                    <td>USE</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>104</td>
                    <td>6</td>
                    <td>TABLE</td>
                    <td>dim_users</td>
                    <td>SELECT</td>
                </tr>
            
                <tr>
                    <td>sample_sql\comprehensive_snowflake.sql</td>
                    <td>111</td>
                    <td>11</td>
                    <td>TABLE</td>
                    <td>raw_events</td>
                    <td>COPY_INTO_TABLE</td>
                </tr>
            
            </tbody>
        </table>
    </details>

    <footer style="margin-top:3em; color:#888; font-size:0.9em;">
        <p>Generated by SQL Analyzer &mdash; <code>--format html</code> output</p>
    </footer>
</body>
</html> 